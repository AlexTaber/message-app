<%= form_for subscription, html: { id: "subscription-form" } do |f| %>
  <%= f.hidden_field :user_id, value: current_user.id %>

  <div class="tier-select">
    <p><b> Choose Your Level</b></p>
    <%= collection_radio_buttons nil, :tier_id, Tier.all_published, :id, :name, checked: tier_id %>
  </div>

  <% if card_token %>
    <%= f.hidden_field :stripe_card_token, value: card_token %>
  <% else %>

    <% if tier_id == 1 %>
      <div id="card-form" class="hidden">
    <% else %>
      <div id="card-form">
    <% end %>

      <%= f.hidden_field :stripe_card_token %>

      <div class="field">
        <%= label_tag :card_number, "Credit Card Number" %>
        <%= text_field_tag :card_number, nil, name: nil %>
      </div>
      <div class="field">
        <%= label_tag :card_code, "Security Code on Card (CVV)" %>
        <%= text_field_tag :card_code, nil, name: nil %>
      </div>
      <div class="field">
        <%= label_tag :card_month, "Card Expiration" %>
        <%= select_month nil, {add_month_numbers: true}, {name: nil, id: "card_month"} %>
        <%= select_year nil, {start_year: Date.today.year, end_year: Date.today.year+15}, {name: nil, id: "card_year"} %>
      </div>
    </div>
  <% end %>

  <%= f.submit "Submit Subscription", class: "primary button-primary" %>
<% end %>